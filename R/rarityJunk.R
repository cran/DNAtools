## if(m==1){
##   if(p==1){ ## p==1
##     if(fm==1){ ## fm==1
##       if(fp==1) M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##       else M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[4,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+(fp-1))] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##     }
##     else{ ## fm>1
##       if(fp==1) M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[3,s]*M[[s-1]][m*(S+1)+(1+p),(fm-1)*(S+1)+(1+fp)] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##       else M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[3,s]*M[[s-1]][m*(S+1)+(1+p),(fm-1)*(S+1)+(1+fp)] + q[4,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+(fp-1))] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##     }
##   }
##   else{ ## p>1
##     if(fm==1){ ## fm==1
##       if(fp==1) M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[2,s]*M[[s-1]][m*(S+1)+(1+(p-1)),fm*(S+1)+(1+fp)] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##       else M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[2,s]*M[[s-1]][m*(S+1)+(1+(p-1)),fm*(S+1)+(1+fp)] + q[4,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+(fp-1))] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##     }
##     else{ ## fm>1
##       if(fp==1) M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[2,s]*M[[s-1]][m*(S+1)+(1+(p-1)),fm*(S+1)+(1+fp)] + q[3,s]*M[[s-1]][m*(S+1)+(1+p),(fm-1)*(S+1)+(1+fp)] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##       else M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[2,s]*M[[s-1]][m*(S+1)+(1+(p-1)),fm*(S+1)+(1+fp)] + q[3,s]*M[[s-1]][m*(S+1)+(1+p),(fm-1)*(S+1)+(1+fp)] + q[4,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+(fp-1))] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##     }
##   }
## }
## else{ ## m>1
##   if(p==1){ ## p==1
##     if(fm==1){ ## fm==1
##       if(fp==1) M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[1,s]*M[[s-1]][(m-1)*(S+1)+(1+p),fm*(S+1)+(1+fp)] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##       else M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[1,s]*M[[s-1]][(m-1)*(S+1)+(1+p),fm*(S+1)+(1+fp)] + q[4,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+(fp-1))] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##                 }
##     else{ ## fm>1
##       if(fp==1) M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[1,s]*M[[s-1]][(m-1)*(S+1)+(1+p),fm*(S+1)+(1+fp)] + q[3,s]*M[[s-1]][m*(S+1)+(1+p),(fm-1)*(S+1)+(1+fp)] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##       else M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[1,s]*M[[s-1]][(m-1)*(S+1)+(1+p),fm*(S+1)+(1+fp)] + q[3,s]*M[[s-1]][m*(S+1)+(1+p),(fm-1)*(S+1)+(1+fp)] + q[4,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+(fp-1))] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##     }
##   }
##   else{ ## p>1
##     if(fm==1){ ## fm==1
##                   if(fp==1) M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[1,s]*M[[s-1]][(m-1)*(S+1)+(1+p),fm*(S+1)+(1+fp)] + q[2,s]*M[[s-1]][m*(S+1)+(1+(p-1)),fm*(S+1)+(1+fp)] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##                   else M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[1,s]*M[[s-1]][(m-1)*(S+1)+(1+p),fm*(S+1)+(1+fp)] + q[2,s]*M[[s-1]][m*(S+1)+(1+(p-1)),fm*(S+1)+(1+fp)] + q[4,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+(fp-1))] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##                 }
##     else{ ## fm>1
##       if(fp==1) M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[1,s]*M[[s-1]][(m-1)*(S+1)+(1+p),fm*(S+1)+(1+fp)] + q[2,s]*M[[s-1]][m*(S+1)+(1+(p-1)),fm*(S+1)+(1+fp)] + q[3,s]*M[[s-1]][m*(S+1)+(1+p),(fm-1)*(S+1)+(1+fp)] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##       else M[[s]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)] <- q[1,s]*M[[s-1]][(m-1)*(S+1)+(1+p),fm*(S+1)+(1+fp)] + q[2,s]*M[[s-1]][m*(S+1)+(1+(p-1)),fm*(S+1)+(1+fp)] + q[3,s]*M[[s-1]][m*(S+1)+(1+p),(fm-1)*(S+1)+(1+fp)] + q[4,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+(fp-1))] + q[5,s]*M[[s-1]][m*(S+1)+(1+p),fm*(S+1)+(1+fp)]
##     }
##   }
## }
